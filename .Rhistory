points(vl[P<0.1,], col='red', , pch=15) # some structure I guess
points(vl[P<p_bon,],col='green', pch=15) # soo basically nothing so sad
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=15) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch=15)
# Bonferonni control
points(vl[P<p_bon,],col='green', pch=15) # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch=11)
# Bonferonni control
points(vl[P<p_bon,],col='green', pch=2) # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch=11)
# Bonferonni control
points(vl[P<p_bon,],col='green', pch=3) # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch=o)
# Bonferonni control
points(vl[P<p_bon,],col='green', pch=3) # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='green', pch=3) # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='green', pch='+') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='+') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch=22) # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch=O) # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='O') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='0') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='#') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=15)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='blue', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'blue', 'green'), pch=20)
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c(20,20,'o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c('20','20','o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c(20,20,o,|))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c(20,20,o,'|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c(20,20,'o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c(NA,NA,'o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c(NA,20,'o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c(NA,'20','o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("All Voxels", "No control", "B-H FDR", "Bonferonni"), col=c("grey", 'red', 'black', 'black'), pch=c('o','o','o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("No control", "B-H FDR", "Bonferonni"), col=c('red', 'black', 'black'), pch=c(o','o','|'))
# FWE by permutation ---------------
# randomize images by reordering rows of X, the design matrix
nimages=dim(X)[1]
n_repeats=5
P_min_null=numeric(n_repeats)
for (i in 1:n_repeats){
X_random=X[sample(1:nimages),]
P_null = numeric(nvoxels)
for (j in 1:nvoxels){
res <- lm(train_resp[,j] ~ X_random)
res2 <- linearHypothesis(res, t(contrast_vec))
P_null[j]=res2$'Pr(>F)'[2]
}
P_min_null[i]=min(P_null)
print(i)
}
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("No control", "B-H FDR", "Bonferonni"), col=c('red', 'black', 'black'), pch=c('o','o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("No control", "B-H FDR", "Bonferonni"), col=c('red', 'black', 'black'), pch=c(20,'o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("No control", "B-H FDR", "Bonferonni"), col=c('red', 'black', 'black'), pch=c('20','o','|'))
# BH -------------------
alpha <- 0.1;
for (vox in 1:nvoxels){
if (sort(P)[vox] > alpha*vox/nvoxels){
break
}
}
plot(vl, col='grey', pch=20)
# Just P < 0.1
points(vl[P<0.1,], col='red', pch=20) # some structure I guess
# BH FDR control
points(vl[order(P)[1:15],], col='black', pch='o')
# Bonferonni control
points(vl[P<p_bon,],col='black', pch='|') # soo basically nothing so sad
legend("bottomright",c("No control", "B-H FDR", "Bonferonni"), col=c('red', 'black', 'black'), pch=c('o','o','|'))
library('car')
library('pdist')
load('ex4.RData')
knitr::opts_chunk$set(warnings=FALSE)
library('car')
library('pdist')
load('ex4.RData')
getwd()
setwd(Desktop/classes/stat312)
setwd(~/Desktop/classes/stat312)
setwd(Desktop/classes/stat312)
getwd
getwd()
setwd('Desktop/classes/stat312'')
load('ex4.RData')
load('ex4.RData')
gewd()
getwd()
setwd('Desktop/classes/stat312'')
setwd('Desktop/classes/stat312)
setwd('Desktop/classes/stat312')
load('ex4.RData')
```{r fig.width=5, fig.height=6}
rematwav <- function(ind, wav = wav.pyr) {
wav <- matrix(Re(wav[, ind]), 128, 128)
}
old.par <- par()
layout(matrix(1:42, 7, 6))
par(mar = c(0,0,0,0))
for (i in which(vertical_features)) {
image(rematwav(i, wav.pyr42), axes=false)
}
for (i in which(horizontal_features)) {
for (i in which(vertical_features)) {
image(rematwav(i, wav.pyr42), axes=FALSE)
}
for (i in which(horizontal_features)) {
image(rematwav(i, wav.pyr42), axes=FALSE)
}
par(old.par)
plot(1:nvoxels/nvoxels, sort(P), main="P-P Plot", xlab="Uniform")
}
plot(1:nvoxels/nvoxels, sort(P), main="P-P Plot", xlab="Uniform")
plot(1:nvoxels/nvoxels, sort(P), main="P-P Plot", xlab="Uniform")
lines(0:1,0:1)
load('ex4.RData')
dim(X)
X2=X
X = feature_train[, features]
image(X)
image(X2)
pthres
pthres<-alpha*vox/nvoxels
lines(c(pthres, pthres),c(0,3), col='blue')
hist(P_min_null,breaks=10)
lines(c(p_bon, p_bon),c(0,3), col='red')
lines(c(pthres, pthres),c(0,3), col='blue')
legend("bottomright", c('Bonferonni','BH FDR'),lty=1, col=c('red','blue'))
pthres
