%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer Presentation
% LaTeX Template
% Version 1.0 (10/11/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND THEMES
%----------------------------------------------------------------------------------------

\documentclass{beamer}

\mode<presentation> {

% The Beamer class comes with a number of default slide themes
% which change the colors and layouts of slides. Below this is a list
% of all the themes, uncomment each in turn to see what they look like.

%\usetheme{default}
%\usetheme{AnnArbor}
%\usetheme{Antibes}
%\usetheme{Bergen}
%\usetheme{Berkeley}
%\usetheme{Berlin}
%\usetheme{Boadilla}
%\usetheme{CambridgeUS}
%\usetheme{Copenhagen}
%\usetheme{Darmstadt}
%\usetheme{Dresden}
%\usetheme{Frankfurt}
%\usetheme{Goettingen}
%\usetheme{Hannover}
%\usetheme{Ilmenau}
%\usetheme{JuanLesPins}
%\usetheme{Luebeck}
\usetheme{Madrid}
%\usetheme{Malmoe}
%\usetheme{Marburg}
%\usetheme{Montpellier}
%\usetheme{PaloAlto}
%\usetheme{Pittsburgh}
%\usetheme{Rochester}
%\usetheme{Singapore}
%\usetheme{Szeged}
%\usetheme{Warsaw}

% As well as themes, the Beamer class has a number of color themes
% for any slide theme. Uncomment each of these in turn to see how it
% changes the colors of your current slide theme.

%\usecolortheme{albatross}
%\usecolortheme{beaver}
%\usecolortheme{beetle}
%\usecolortheme{crane}
%\usecolortheme{dolphin}
%\usecolortheme{dove}
%\usecolortheme{fly}
%\usecolortheme{lily}
%\usecolortheme{orchid}
%\usecolortheme{rose}
%\usecolortheme{seagull}
%\usecolortheme{seahorse}
%\usecolortheme{whale}
%\usecolortheme{wolverine}

%\setbeamertemplate{footline} % To remove the footer line in all slides uncomment this line
%\setbeamertemplate{footline}[page number] % To replace the footer line in all slides with a simple slide count uncomment this line

%\setbeamertemplate{navigation symbols}{} % To remove the navigation symbols from the bottom of all slides uncomment this line
}

\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage{multirow}
%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------


\title[Application of EMD to DWI]{Quantifying error in estimates of human brain fiber
directions using Earth Moverâ€™s Distance}

\author{Charles Zheng and Ariel Rokem} % Your name
\institute[Stanford] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{
Stanford University \\
Joint with Franco Pestilli, Indiana University\\ % Your institution for the title page
%\medskip
%\textit{snarles@stanford.edu} % Your email address
}
\date{\today} % Date, can be changed to a custom date

\begin{document}

\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

\begin{frame}
\frametitle{Overview} % Table of contents slide, comment this block out to remove it
\tableofcontents % Throughout your presentation, if you choose to use \section{} and \subsection{} commands, these will automatically be printed on this slide as an overview of your presentation
\end{frame}

%----------------------------------------------------------------------------------------
%	PRESENTATION SLIDES
%----------------------------------------------------------------------------------------

%------------------------------------------------
\section{Introduction} % Sections can be created in order to organize your presentation into discrete blocks, all sections and subsections are automatically printed in the table of contents as an overview of the talk
%------------------------------------------------

\subsection{DWI (Diffusion-weighted imaging)}

\begin{frame}
\frametitle{Goal: Infer connective structure of brain from diffusion MRI images}
[needed: images of barin slices]
\begin{itemize}
\item Acquire 150 images of the same brain using different directional magnetic fields
\item Each image consists of 106x76x81 'voxels'
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{A fiber population generates a diffusion MRI signal}
[needed: diffusion surfaces]
\begin{itemize}
\item Look a a single voxel
\item $y_1,\hdots,y_{150}$ are the values of that voxel across 150 images
\item A fiber in direction $v$ generates a diffusion signal
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{The shape of the diffusion signal may vary}
[needed: diffusion surfaces with varying kappa]
\begin{itemize}
\item A single fiber diffusion signal varies in shape from 'spherelike' to 'disclike'
\item The shape is described by parameter $\kappa$
\item $\kappa$ depends on both fiber properties and acquisition settings
\end{itemize}
\end{frame}

\begin{frame}
[needed: graphical representation of NNLS]
\frametitle{Where fibers cross, the diffusion signals are combined}
\begin{itemize}
\item In a voxel with multiple fiber populations, the observed signal is a sum of component signals
\item Non-negative least squares can be used to reconstruct the fiber directions
\item \textbf{But how can we quantify the accuracy of our reconstruction?}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{We need to extend angular error to handle multiple fibers}
\begin{center}
\includegraphics[scale=0.8]{sketch01.png}
\includegraphics[scale=0.8]{sketch02.png}
\end{center}
\begin{itemize}
\item When truth and estimate are a single fiber, obvious to use angular error (AE)
\item \textbf{What about multiple fibers?}
\item Earth Mover's distance (EMD) and 2-Wasserstein extend AE
\item Kernel smoothed $L_p$ distances/KL divergence do not
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Earth mover's distance is a Wasserstein distance}
\centering
\begin{tabular}{cc}
EMD (1-Wasserstein) & 2-Wasserstein\\
\includegraphics[scale=0.6]{sketch10a.png}&
\includegraphics[scale=0.6]{sketch10b.png}
\end{tabular}
\[p\text{-Wasserstein} = \sqrt[p]{\sum \text{weight}\cdot \text{distance}^p}\]
\end{frame}

\section{Methods}
\subsection{Metrics}
\begin{frame}
\frametitle{Wasserstein distances do not use smoothing}
\centering
\includegraphics[scale=0.16]{figure_schematic_1.pdf}
\includegraphics[scale=0.16]{figure_schematic_2.pdf}
\includegraphics[scale=0.16]{figure_schematic_3.pdf}
\includegraphics[scale=0.16]{figure_schematic_4.pdf}
\end{frame}



\begin{frame}
\frametitle{Wasserstein distances are scale equivariant}
\begin{itemize}
\item Wasserstein distances are scale equivariant
\includegraphics[scale=0.4,trim = 0mm 10mm 0mm 10mm,clip]{sketch08a.png}
\item Distances which use smoothing are not
\includegraphics[scale=0.4,trim = 0mm 10mm 0mm 10mm,clip]{sketch08b.png}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{EMD is more robust to outliers than 2-Wasserstein}
\begin{itemize}
\item How much does $d(P,Q)$ differ from $d(P,(1-\epsilon)Q + \epsilon \delta_x)$?
\item EMD (1-Wasserstein) $\approx \epsilon||x||$
\includegraphics[scale=0.4,trim = 0mm 10mm 0mm 10mm,clip]{sketch09a.png}
\item 2-Wasserstein $\approx \sqrt{\epsilon}||x||$
\includegraphics[scale=0.4,trim = 0mm 10mm 0mm 10mm,clip]{sketch09b.png}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{EMD extends angular error}
\begin{center}
\includegraphics[scale=0.8]{sketch01.png}
\includegraphics[scale=0.8]{sketch02a.png}
\end{center}
\end{frame}


\subsection{Inferring error from replicate error}
\begin{frame}
\frametitle{Error cannot be measured in experimental data}
\begin{itemize}
\item Error is defined as the distance between the estimated fiber configuration $\hat{f}$
and the true fiber configuration $f$
\item We do not know the true fiber configuration outside of simulations
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Replicate error can be measured in experimental data}
\begin{itemize}
\item Replicate error is the distance between one estimate $\hat{f}_1$ and an estimate from an independent data set $\hat{f}_2$
\item \textbf{Can we use replicate error as a proxy for the error?}
\end{itemize}
\end{frame}

\section{Results}

\subsection{Simulation}
\begin{frame}
\frametitle{Simulation setup}
\begin{itemize}
\item Generate true fODF $f$ from two randomly distributed true directions
\item Generate signal from true fODF, varying a kernel shape parameter $\kappa$
\item Generate two sets of data by adding noise to the simulated signal
\item Obtain estimates $\hat{f}_1$, $\hat{f}_2$ from non-negative least squares
\item Measure correlation between error $d(\hat{f}_1,f)$ and
  replicate error $d(\hat{f}_1,\hat{f}_2)$ as measured by various metrics
  over repeated trials
\begin{itemize} 
\item EMD
\item root mean integrated squared error (RMISE) of estimated signal
\item total variation with smoothing bandwidths of 1, 0.1 and 0.01
  ($TV_1$, $TV_{10}$, $TV_{100}$)\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Simulation results}
\begin{center}
\begin{tabular}{cc}
\multirow{3}{*}{\includegraphics[scale=.35]{plot_test13.png}} & \\
& \includegraphics[scale=.08]{illus6a.pdf}\\
& \includegraphics[scale=.08]{illus6b.pdf}\\
& \includegraphics[scale=.08]{illus6c.pdf}
\end{tabular}
\end{center}
\end{frame}

\subsection{Interpretation}

\begin{frame}
\frametitle{High $\kappa$ produces outliers}
\begin{center}
\begin{tabular}{r|cc}
& Truth & Estimate\\\hline
$\kappa = 2$ &  & \\
& \includegraphics[scale=.15]{illus7a1.pdf} & \includegraphics[scale=.15]{illus7a2.pdf}\\\hline
$\kappa = 30$ &  & \\
& \includegraphics[scale=.15]{illus7b1.pdf} & \includegraphics[scale=.15]{illus7b2.pdf}
\end{tabular}
\end{center}
\end{frame}

\subsection{Application to Real Data}

\begin{frame}
\frametitle{Application to Real Data}
\begin{figure}[htbp]
\centering
\begin{tabular}{cc}
EMD & CVRMSE\\
\includegraphics[scale=0.2]{figure_cccso_1b.png} &
\includegraphics[scale=0.2]{figure_cccso_1c.png}
\\
\includegraphics[scale=0.2]{figure_cccso_2b.png} &
\includegraphics[scale=0.2]{figure_cccso_2c.png}
\end{tabular}
\label{fig:cvemd}
\end{figure}
\end{frame}


%\begin{itemize}
%\item Let $f$ be the true distribution, $\hat{f}_1$ and $\hat{f}_2$ be
%  estimates from independent data
%\item Inaccuracy is $d(f,\hat{f}_1)$ 
%\item Imprecision is $d(\hat{f}_1,\hat{f}_2)$
%\item Inaccuracy can be assessed only in simulations
%\item Imprecision can be measured in experimental settings
%\item IF we use EMD, we can infer inaccuracy from imprecision
%\end{itemize}


\begin{frame}
\frametitle{Conclusions}
EMD has many advantages for error quantification in DWI
\begin{itemize}
\item Extension of angular error
\item Applicable to both continuous estimates of fODF and mixtures of point masses
\item No smoothing parameters
\item Allows imprecision to be used as a substitute for inaccuracy
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Acknowledgements}
The authors thank Trevor Hastie, Brian Wandell, Eero Simoncelli,
Justin Solomon, Leo Guibas and Shuo Xie for useful discussions. CZ was
supported through an NIH grant 1T32GM096982 to Robert Tibshirani and
Chiara Sabatti, AR was supported through NIH fellowship
F32-EY022294. FP was supported through NSF grant BCS1228397 to Brian
Wandell
\end{frame}

\begin{frame}
\frametitle{References}
\end{frame}


\end{document}


















